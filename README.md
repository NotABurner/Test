Commit from octokit prototype, cleaned and commented version